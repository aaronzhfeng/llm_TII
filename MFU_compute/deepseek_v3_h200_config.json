{
  "_comment": "MFU configuration for DeepSeek V3 on H200 hardware",
  "model_name": "deepseek_v3",
  "hardware": "H200",
  "gpus": 8,
  "precision": "FP16",

  "model_config": {
    "hidden_size": 7168,
    "intermediate_size": 18432,
    "moe_intermediate_size": 2048,
    "num_hidden_layers": 61,
    "num_attention_heads": 128,
    "num_key_value_heads": 128,
    "n_routed_experts": 256,
    "n_shared_experts": 1,
    "num_experts_per_tok": 8,
    "first_k_dense_replace": 3,
    "vocab_size": 129280,
    "tie_word_embeddings": false,
    "max_position_embeddings": 163840,
    "q_lora_rank": 1536,
    "kv_lora_rank": 512,
    "qk_nope_head_dim": 128,
    "qk_rope_head_dim": 64,
    "v_head_dim": 128
  },

  "hardware_specs": {
    "peak_tflops_fp16": 1979,
    "peak_tflops_fp8": 3979,
    "peak_tflops_bf16": 1979,
    "peak_tflops_fp32": 989,
    "memory_gb": 141,
    "memory_bandwidth_gb_s": 4800,
    "interconnect_bandwidth_gb_s": 900,
    "nvlink_bandwidth_gb_s": 900
  },

  "training_config": {
    "batch_size": 24,
    "sequence_length": 4096,
    "gradient_accumulation_steps": 2,
    "mixed_precision": true,
    "optimizer": "AdamW",
    "learning_rate": 1e-4,
    "gradient_checkpointing": true
  },

  "performance_measurements": {
    "_comment": "These should be measured during actual training",
    "tokens_per_second_achieved": 0,
    "throughput_tokens_per_sec_per_gpu": 0,
    "wall_clock_time_per_iteration_ms": 0,
    "peak_memory_used_gb": 0,
    "communication_overhead_percent": 0
  },

  "training_objectives": {
    "_comment": "Training goals for time estimation",
    "total_training_tokens": 1.4e12,
    "target_loss": 2.0,
    "evaluation_interval_tokens": 1e9
  },

  "mfu_targets": {
    "target_mfu_percent": 65,
    "realistic_mfu_percent": 50,
    "minimum_acceptable_mfu_percent": 35
  },

  "references": {
    "paper": "DeepSeek-V3 Technical Report",
    "authors": "DeepSeek AI",
    "year": 2024,
    "url": "https://arxiv.org/abs/2412.19437",
    "hardware_ref": "NVIDIA H200 Tensor Core GPU",
    "hardware_url": "https://www.nvidia.com/en-us/data-center/h200/"
  }
}

