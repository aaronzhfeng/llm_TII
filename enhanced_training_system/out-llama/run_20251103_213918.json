{
  "run_name": "run_20251103_213918",
  "start_time": "2025-11-03T21:39:18.319428",
  "config": {
    "MODULAR_ARCH_AVAILABLE": true,
    "LOGGER_AVAILABLE": true,
    "out_dir": "out-llama",
    "eval_interval": 2000,
    "log_interval": 10,
    "eval_iters": 200,
    "eval_only": false,
    "always_save_checkpoint": true,
    "init_from": "scratch",
    "save_log_to_json": true,
    "log_save_interval": 100,
    "gradient_log_interval": 50,
    "wandb_log": false,
    "wandb_project": "owt",
    "wandb_run_name": "gpt2",
    "dataset": "shakespeare",
    "gradient_accumulation_steps": 40,
    "batch_size": 12,
    "block_size": 1024,
    "n_layer": 12,
    "n_head": 12,
    "n_embd": 768,
    "dropout": 0.0,
    "bias": false,
    "arch_preset": "llama",
    "normalization": "layernorm_nobias",
    "activation": "gelu",
    "attention_backend": "sdpa",
    "position_encoding": "learned_absolute",
    "norm_position": "post",
    "ffn_type": "standard",
    "weight_tying": true,
    "rope_theta": 10000.0,
    "learning_rate": 0.0006,
    "max_iters": 100,
    "weight_decay": 0.1,
    "beta1": 0.9,
    "beta2": 0.95,
    "grad_clip": 1.0,
    "decay_lr": true,
    "warmup_iters": 2000,
    "lr_decay_iters": 600000,
    "min_lr": 6e-05,
    "backend": "nccl",
    "use_zero1": false,
    "use_fsdp": false,
    "fsdp_min_num_params": 1000000.0,
    "fsdp_activation_checkpointing": false,
    "device": "cuda",
    "dtype": "bfloat16",
    "compile": true
  },
  "startup_info": {
    "timestamp": "2025-11-03T21:39:18.320789",
    "model": {
      "total_params": 162220800,
      "trainable_params": 162220800,
      "non_embedding_params": 162220800
    },
    "optimizer": {
      "type": "AdamW",
      "param_groups": 2
    },
    "config": {
      "MODULAR_ARCH_AVAILABLE": true,
      "LOGGER_AVAILABLE": true,
      "out_dir": "out-llama",
      "eval_interval": 2000,
      "log_interval": 10,
      "eval_iters": 200,
      "eval_only": false,
      "always_save_checkpoint": true,
      "init_from": "scratch",
      "save_log_to_json": true,
      "log_save_interval": 100,
      "gradient_log_interval": 50,
      "wandb_log": false,
      "wandb_project": "owt",
      "wandb_run_name": "gpt2",
      "dataset": "shakespeare",
      "gradient_accumulation_steps": 40,
      "batch_size": 12,
      "block_size": 1024,
      "n_layer": 12,
      "n_head": 12,
      "n_embd": 768,
      "dropout": 0.0,
      "bias": false,
      "arch_preset": "llama",
      "normalization": "layernorm_nobias",
      "activation": "gelu",
      "attention_backend": "sdpa",
      "position_encoding": "learned_absolute",
      "norm_position": "post",
      "ffn_type": "standard",
      "weight_tying": true,
      "rope_theta": 10000.0,
      "learning_rate": 0.0006,
      "max_iters": 100,
      "weight_decay": 0.1,
      "beta1": 0.9,
      "beta2": 0.95,
      "grad_clip": 1.0,
      "decay_lr": true,
      "warmup_iters": 2000,
      "lr_decay_iters": 600000,
      "min_lr": 6e-05,
      "backend": "nccl",
      "use_zero1": false,
      "use_fsdp": false,
      "fsdp_min_num_params": 1000000.0,
      "fsdp_activation_checkpointing": false,
      "device": "cuda",
      "dtype": "bfloat16",
      "compile": true
    },
    "hardware": {
      "gpu_name": "NVIDIA A100-PCIE-40GB",
      "num_gpus": 2,
      "gpu_memory_gb": 42.285268992,
      "precision": "bfloat16",
      "parallelism": "DDP"
    }
  },
  "training_iterations": [
    {
      "iter": 0,
      "loss": 10.921577215194702,
      "time_ms": 77096.31013870239,
      "mfu": -100.0
    },
    {
      "iter": 10,
      "loss": 10.796133279800415,
      "time_ms": 1855.7155132293701,
      "mfu": {
        "mfu": 0.2524062592117212,
        "mfu_percent": 25.24062592117212,
        "flops_achieved": 157501505748114.03,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 132434.0925362645,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 157.50150574811403,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 20,
      "loss": 10.07683515548706,
      "time_ms": 1873.025894165039,
      "mfu": {
        "mfu": 0.2500735373251133,
        "mfu_percent": 25.007353732511326,
        "flops_achieved": 156045887290870.7,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 131210.1454473246,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 156.0458872908707,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 30,
      "loss": 9.285778403282166,
      "time_ms": 1882.4257850646973,
      "mfu": {
        "mfu": 0.24882479541645589,
        "mfu_percent": 24.882479541645587,
        "flops_achieved": 155266672339868.47,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 130554.94774342641,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 155.26667233986848,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 40,
      "loss": 9.011964201927185,
      "time_ms": 1892.9455280303955,
      "mfu": {
        "mfu": 0.2474419912879096,
        "mfu_percent": 24.74419912879096,
        "flops_achieved": 154403802563655.6,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 129829.40943668495,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 154.4038025636556,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 50,
      "loss": 8.772905468940735,
      "time_ms": 1904.0882587432861,
      "mfu": {
        "mfu": 0.24599395994623097,
        "mfu_percent": 24.599395994623098,
        "flops_achieved": 153500231006448.12,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 129069.64730836774,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 153.50023100644813,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 60,
      "loss": 8.556343913078308,
      "time_ms": 1906.0144424438477,
      "mfu": {
        "mfu": 0.24574536290229804,
        "mfu_percent": 24.574536290229805,
        "flops_achieved": 153345106451033.97,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 128939.21185869515,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 153.34510645103396,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 70,
      "loss": 8.385581970214844,
      "time_ms": 1914.2951965332031,
      "mfu": {
        "mfu": 0.24468233097154954,
        "mfu_percent": 24.468233097154954,
        "flops_achieved": 152681774526246.9,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 128381.45362589449,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 152.6817745262469,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 80,
      "loss": 8.063234686851501,
      "time_ms": 1912.8401279449463,
      "mfu": {
        "mfu": 0.24486845712432984,
        "mfu_percent": 24.486845712432984,
        "flops_achieved": 152797917245581.8,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 128479.11145822285,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 152.7979172455818,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 90,
      "loss": 7.776495814323425,
      "time_ms": 1920.0043678283691,
      "mfu": {
        "mfu": 0.24395476317856732,
        "mfu_percent": 24.395476317856733,
        "flops_achieved": 152227772223426.0,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 127999.70881210448,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 152.227772223426,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    },
    {
      "iter": 100,
      "loss": 7.4441927671432495,
      "time_ms": 1871.1552619934082,
      "mfu": {
        "mfu": 0.2503235409531904,
        "mfu_percent": 25.032354095319043,
        "flops_achieved": 156201889554790.8,
        "flops_per_token": 1189282176.0,
        "tokens_per_sec": 131341.31891235104,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 156.20188955479082,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "attention_flops_per_layer": 24159191040.0,
        "ffn_flops_per_layer": 9663676416.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "12L-12H-768D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 2.564425728,
        "reserved_gb": 15.338569728,
        "max_allocated_gb": 14.935453184,
        "max_reserved_gb": 15.338569728
      }
    }
  ],
  "eval_steps": [
    {
      "iter": 0,
      "train_loss": 10.933943748474121,
      "val_loss": 10.933277130126953,
      "timestamp": "2025-11-03T21:39:57.543969",
      "lr": 2.998500749625187e-07
    }
  ],
  "checkpoints": [],
  "metadata": {
    "world_size": 2,
    "device": "cuda:0",
    "dtype": "bfloat16",
    "compile": true,
    "use_zero1": false,
    "use_fsdp": false
  },
  "end_time": "2025-11-03T21:43:46.999897",
  "summary": {
    "total_iterations": 11,
    "final_iter": 100,
    "final_train_loss": 7.4441927671432495,
    "best_val_loss": 10.933277130126953,
    "avg_time_ms": 8729.892774061724,
    "avg_mfu": 24.74314998317366,
    "total_eval_steps": 1,
    "total_checkpoints": 0
  }
}