{
  "run_name": "run_20251115_145011",
  "start_time": "2025-11-15T14:50:11.449287",
  "config": {
    "MODULAR_ARCH_AVAILABLE": true,
    "LOGGER_AVAILABLE": true,
    "out_dir": "out-llama-1.36b",
    "eval_interval": 200,
    "log_interval": 10,
    "eval_iters": 50,
    "eval_only": false,
    "eval_at_start": false,
    "always_save_checkpoint": true,
    "init_from": "scratch",
    "save_log_to_json": true,
    "log_save_interval": 10,
    "gradient_log_interval": 10,
    "wandb_log": false,
    "wandb_project": "llama-1.36b",
    "wandb_run_name": "run-1",
    "dataset": "slimpajama_6b_llama",
    "gradient_accumulation_steps": 32,
    "batch_size": 6,
    "block_size": 2048,
    "n_layer": 18,
    "n_head": 18,
    "n_embd": 2304,
    "dropout": 0.0,
    "bias": false,
    "arch_preset": "llama",
    "normalization": "layernorm_nobias",
    "activation": "gelu",
    "attention_backend": "flash_attn_2",
    "position_encoding": "learned_absolute",
    "norm_position": "post",
    "ffn_type": "standard",
    "weight_tying": true,
    "rope_theta": 10000.0,
    "d_ff": 6144,
    "intermediate_size": 6144,
    "learning_rate": 0.0003,
    "max_iters": 100,
    "weight_decay": 0.1,
    "beta1": 0.9,
    "beta2": 0.95,
    "grad_clip": 1.0,
    "decay_lr": true,
    "warmup_iters": 2000,
    "lr_decay_iters": 25000,
    "min_lr": 3e-05,
    "backend": "nccl",
    "use_zero1": true,
    "use_fsdp": false,
    "fsdp_min_num_params": 1000000.0,
    "fsdp_activation_checkpointing": false,
    "device": "cuda",
    "dtype": "bfloat16",
    "compile": true
  },
  "startup_info": {
    "timestamp": "2025-11-15T14:50:11.453035",
    "model": {
      "total_params": 1294159104,
      "trainable_params": 1294159104,
      "non_embedding_params": 1294159104
    },
    "optimizer": {
      "type": "ZeroRedundancyOptimizer",
      "param_groups": 2
    },
    "config": {
      "MODULAR_ARCH_AVAILABLE": true,
      "LOGGER_AVAILABLE": true,
      "out_dir": "out-llama-1.36b",
      "eval_interval": 200,
      "log_interval": 10,
      "eval_iters": 50,
      "eval_only": false,
      "eval_at_start": false,
      "always_save_checkpoint": true,
      "init_from": "scratch",
      "save_log_to_json": true,
      "log_save_interval": 10,
      "gradient_log_interval": 10,
      "wandb_log": false,
      "wandb_project": "llama-1.36b",
      "wandb_run_name": "run-1",
      "dataset": "slimpajama_6b_llama",
      "gradient_accumulation_steps": 32,
      "batch_size": 6,
      "block_size": 2048,
      "n_layer": 18,
      "n_head": 18,
      "n_embd": 2304,
      "dropout": 0.0,
      "bias": false,
      "arch_preset": "llama",
      "normalization": "layernorm_nobias",
      "activation": "gelu",
      "attention_backend": "flash_attn_2",
      "position_encoding": "learned_absolute",
      "norm_position": "post",
      "ffn_type": "standard",
      "weight_tying": true,
      "rope_theta": 10000.0,
      "d_ff": 6144,
      "intermediate_size": 6144,
      "learning_rate": 0.0003,
      "max_iters": 100,
      "weight_decay": 0.1,
      "beta1": 0.9,
      "beta2": 0.95,
      "grad_clip": 1.0,
      "decay_lr": true,
      "warmup_iters": 2000,
      "lr_decay_iters": 25000,
      "min_lr": 3e-05,
      "backend": "nccl",
      "use_zero1": true,
      "use_fsdp": false,
      "fsdp_min_num_params": 1000000.0,
      "fsdp_activation_checkpointing": false,
      "device": "cuda",
      "dtype": "bfloat16",
      "compile": true
    },
    "hardware": {
      "gpu_name": "NVIDIA A100-SXM4-80GB",
      "num_gpus": 2,
      "gpu_memory_gb": 85.097971712,
      "precision": "bfloat16",
      "parallelism": "DDP+ZeRO-1"
    }
  },
  "training_iterations": [
    {
      "iter": 0,
      "loss": 10.81769847869873,
      "time_ms": 36738.844871520996,
      "mfu": -100.0
    },
    {
      "iter": 10,
      "loss": 10.779434204101562,
      "time_ms": 7916.75591468811,
      "mfu": {
        "mfu": 0.3495989318715538,
        "mfu_percent": 34.95989318715538,
        "flops_achieved": 218149733487849.56,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24834.41476769915,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.14973348784957,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 20,
      "loss": 10.44107437133789,
      "time_ms": 7920.506000518799,
      "mfu": {
        "mfu": 0.34943340886068186,
        "mfu_percent": 34.943340886068185,
        "flops_achieved": 218046447129065.47,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24822.656530671404,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.04644712906546,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 30,
      "loss": 9.495923042297363,
      "time_ms": 7920.480728149414,
      "mfu": {
        "mfu": 0.3494345238195445,
        "mfu_percent": 34.94345238195445,
        "flops_achieved": 218047142863395.75,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24822.735733862028,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.04714286339575,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 40,
      "loss": 8.807818412780762,
      "time_ms": 7909.51943397522,
      "mfu": {
        "mfu": 0.34991878264742626,
        "mfu_percent": 34.991878264742624,
        "flops_achieved": 218349320371994.0,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24857.135966500486,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.349320371994,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 50,
      "loss": 8.687286376953125,
      "time_ms": 7901.072978973389,
      "mfu": {
        "mfu": 0.35029285503731467,
        "mfu_percent": 35.029285503731465,
        "flops_achieved": 218582741543284.34,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24883.708899186233,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.58274154328436,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 60,
      "loss": 8.343545913696289,
      "time_ms": 7931.243896484375,
      "mfu": {
        "mfu": 0.34896032044728603,
        "mfu_percent": 34.89603204472861,
        "flops_achieved": 217751239959106.5,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24789.04980934315,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 217.7512399591065,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 70,
      "loss": 8.282522201538086,
      "time_ms": 7915.886640548706,
      "mfu": {
        "mfu": 0.349637322682898,
        "mfu_percent": 34.963732268289796,
        "flops_achieved": 218173689354128.34,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24837.141930871778,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.17368935412836,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 80,
      "loss": 8.109156608581543,
      "time_ms": 7907.987594604492,
      "mfu": {
        "mfu": 0.3499865646667332,
        "mfu_percent": 34.998656466673324,
        "flops_achieved": 218391616352041.53,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24861.950989167315,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.39161635204152,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 90,
      "loss": 7.733221054077148,
      "time_ms": 7915.522813796997,
      "mfu": {
        "mfu": 0.3496533933094858,
        "mfu_percent": 34.96533933094858,
        "flops_achieved": 218183717425119.16,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24838.28353792453,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 218.18371742511917,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    },
    {
      "iter": 100,
      "loss": 7.926636695861816,
      "time_ms": 7923.65837097168,
      "mfu": {
        "mfu": 0.3492943892939906,
        "mfu_percent": 34.92943892939906,
        "flops_achieved": 217959698919450.12,
        "flops_per_token": 8784170496.0,
        "tokens_per_sec": 24812.781015430115,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 217.95969891945012,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.294159104,
        "non_attn_gflops": 7.764954624,
        "attn_gflops": 1.019215872,
        "attention_flops_per_layer": 434865438720.0,
        "ffn_flops_per_layer": 173946175488.0,
        "attention_to_ffn_ratio": 2.5,
        "architecture": "18L-18H-2304D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 8.578064896,
        "reserved_gb": 39.883636736,
        "max_allocated_gb": 36.12005376,
        "max_reserved_gb": 39.883636736
      }
    }
  ],
  "eval_steps": [],
  "checkpoints": [],
  "metadata": {
    "world_size": 2,
    "device": "cuda:0",
    "dtype": "bfloat16",
    "compile": true,
    "use_zero1": true,
    "use_fsdp": false
  },
  "end_time": "2025-11-15T15:03:59.518709",
  "summary": {
    "total_iterations": 11,
    "final_iter": 100,
    "final_train_loss": 7.926636695861816,
    "best_val_loss": 1000000000.0,
    "avg_time_ms": 10536.498113112017,
    "avg_mfu": 34.96210492636915,
    "total_eval_steps": 0,
    "total_checkpoints": 0
  }
}