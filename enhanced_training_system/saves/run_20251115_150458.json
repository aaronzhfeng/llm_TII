{
  "run_name": "run_20251115_150458",
  "start_time": "2025-11-15T15:04:58.532715",
  "config": {
    "MODULAR_ARCH_AVAILABLE": true,
    "LOGGER_AVAILABLE": true,
    "out_dir": "out-qwen3-1.8b-optimal",
    "eval_interval": 200,
    "log_interval": 10,
    "eval_iters": 50,
    "eval_only": false,
    "eval_at_start": false,
    "always_save_checkpoint": false,
    "init_from": "scratch",
    "save_log_to_json": true,
    "log_save_interval": 10,
    "gradient_log_interval": 10,
    "wandb_log": false,
    "wandb_project": "qwen3-1.8b",
    "wandb_run_name": "optimal-1.8b",
    "dataset": "slimpajama_6b_qwen3",
    "gradient_accumulation_steps": 32,
    "batch_size": 6,
    "block_size": 2048,
    "n_layer": 24,
    "n_head": 16,
    "n_embd": 2048,
    "dropout": 0.0,
    "bias": false,
    "arch_preset": "custom",
    "normalization": "rmsnorm",
    "activation": "silu",
    "attention_backend": "flash_attn_2",
    "position_encoding": "rope",
    "norm_position": "pre",
    "ffn_type": "swiglu",
    "weight_tying": false,
    "rope_theta": 1000000,
    "d_ff": 6144,
    "intermediate_size": 6144,
    "learning_rate": 0.0003,
    "max_iters": 100,
    "weight_decay": 0.1,
    "beta1": 0.9,
    "beta2": 0.95,
    "grad_clip": 1.0,
    "decay_lr": true,
    "warmup_iters": 2000,
    "lr_decay_iters": 25000,
    "min_lr": 3e-05,
    "backend": "nccl",
    "use_zero1": true,
    "use_fsdp": false,
    "fsdp_min_num_params": 1000000.0,
    "fsdp_activation_checkpointing": false,
    "device": "cuda",
    "dtype": "bfloat16",
    "compile": true
  },
  "startup_info": {
    "timestamp": "2025-11-15T15:04:58.537285",
    "model": {
      "total_params": 1829140480,
      "trainable_params": 1829140480,
      "non_embedding_params": 1829140480
    },
    "optimizer": {
      "type": "ZeroRedundancyOptimizer",
      "param_groups": 2
    },
    "config": {
      "MODULAR_ARCH_AVAILABLE": true,
      "LOGGER_AVAILABLE": true,
      "out_dir": "out-qwen3-1.8b-optimal",
      "eval_interval": 200,
      "log_interval": 10,
      "eval_iters": 50,
      "eval_only": false,
      "eval_at_start": false,
      "always_save_checkpoint": false,
      "init_from": "scratch",
      "save_log_to_json": true,
      "log_save_interval": 10,
      "gradient_log_interval": 10,
      "wandb_log": false,
      "wandb_project": "qwen3-1.8b",
      "wandb_run_name": "optimal-1.8b",
      "dataset": "slimpajama_6b_qwen3",
      "gradient_accumulation_steps": 32,
      "batch_size": 6,
      "block_size": 2048,
      "n_layer": 24,
      "n_head": 16,
      "n_embd": 2048,
      "dropout": 0.0,
      "bias": false,
      "arch_preset": "custom",
      "normalization": "rmsnorm",
      "activation": "silu",
      "attention_backend": "flash_attn_2",
      "position_encoding": "rope",
      "norm_position": "pre",
      "ffn_type": "swiglu",
      "weight_tying": false,
      "rope_theta": 1000000,
      "d_ff": 6144,
      "intermediate_size": 6144,
      "learning_rate": 0.0003,
      "max_iters": 100,
      "weight_decay": 0.1,
      "beta1": 0.9,
      "beta2": 0.95,
      "grad_clip": 1.0,
      "decay_lr": true,
      "warmup_iters": 2000,
      "lr_decay_iters": 25000,
      "min_lr": 3e-05,
      "backend": "nccl",
      "use_zero1": true,
      "use_fsdp": false,
      "fsdp_min_num_params": 1000000.0,
      "fsdp_activation_checkpointing": false,
      "device": "cuda",
      "dtype": "bfloat16",
      "compile": true
    },
    "hardware": {
      "gpu_name": "NVIDIA A100-SXM4-80GB",
      "num_gpus": 2,
      "gpu_memory_gb": 85.097971712,
      "precision": "bfloat16",
      "parallelism": "DDP+ZeRO-1"
    }
  },
  "training_iterations": [
    {
      "iter": 0,
      "loss": 12.013786315917969,
      "time_ms": 55142.33875274658,
      "mfu": -100.0
    },
    {
      "iter": 10,
      "loss": 8.872146606445312,
      "time_ms": 10442.147016525269,
      "mfu": {
        "mfu": 0.3675987226241833,
        "mfu_percent": 36.759872262418334,
        "flops_achieved": 229381602917490.38,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18828.311810670457,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.38160291749037,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 20,
      "loss": 6.639283180236816,
      "time_ms": 10459.395170211792,
      "mfu": {
        "mfu": 0.3669925308550025,
        "mfu_percent": 36.69925308550025,
        "flops_achieved": 229003339253521.56,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18797.262824521324,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.00333925352157,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 30,
      "loss": 5.716831207275391,
      "time_ms": 10436.377048492432,
      "mfu": {
        "mfu": 0.36780195722069103,
        "mfu_percent": 36.7801957220691,
        "flops_achieved": 229508421305711.22,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18838.721434312367,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.5084213057112,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 40,
      "loss": 5.250853538513184,
      "time_ms": 10451.483726501465,
      "mfu": {
        "mfu": 0.36727033263185527,
        "mfu_percent": 36.727033263185525,
        "flops_achieved": 229176687562277.7,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18811.49175991806,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.1766875622777,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 50,
      "loss": 4.943995952606201,
      "time_ms": 10435.471534729004,
      "mfu": {
        "mfu": 0.36783387237980686,
        "mfu_percent": 36.78338723798068,
        "flops_achieved": 229528336364999.47,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18840.356120534965,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.52833636499946,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 60,
      "loss": 5.295281410217285,
      "time_ms": 10435.318231582642,
      "mfu": {
        "mfu": 0.36783927615271755,
        "mfu_percent": 36.78392761527176,
        "flops_achieved": 229531708319295.75,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18840.63290039043,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.53170831929575,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 70,
      "loss": 4.85593318939209,
      "time_ms": 10461.843729019165,
      "mfu": {
        "mfu": 0.36690663750609187,
        "mfu_percent": 36.69066375060919,
        "flops_achieved": 228949741803801.34,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18792.863389332302,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 228.94974180380134,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 80,
      "loss": 4.866265773773193,
      "time_ms": 10455.177307128906,
      "mfu": {
        "mfu": 0.36714058422627655,
        "mfu_percent": 36.71405842262765,
        "flops_achieved": 229095724557196.56,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18804.84608003176,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 229.09572455719658,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 90,
      "loss": 4.888179779052734,
      "time_ms": 10482.244491577148,
      "mfu": {
        "mfu": 0.36619255616609603,
        "mfu_percent": 36.6192556166096,
        "flops_achieved": 228504155047643.9,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18756.28832717854,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 228.5041550476439,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    },
    {
      "iter": 100,
      "loss": 4.994311809539795,
      "time_ms": 10506.10089302063,
      "mfu": {
        "mfu": 0.3653610358223958,
        "mfu_percent": 36.53610358223958,
        "flops_achieved": 227985286353175.0,
        "flops_per_token": 12182802432.0,
        "tokens_per_sec": 18713.69806952928,
        "hardware_peak_flops": 624000000000000.0,
        "hardware_peak_tflops": 624.0,
        "achieved_tflops": 227.985286353175,
        "gpu_name": "A100",
        "precision": "bf16",
        "num_gpus": 2.0,
        "model_params_billion": 1.82914048,
        "non_attn_gflops": 10.97484288,
        "attn_gflops": 1.207959552,
        "attention_flops_per_layer": 343597383680.0,
        "ffn_flops_per_layer": 137430564864.0,
        "attention_to_ffn_ratio": 2.500152597204419,
        "architecture": "24L-16H-2048D-RoPE-RMS-SwiGLU-PreNorm"
      },
      "memory": {
        "allocated_gb": 14.733947392,
        "reserved_gb": 61.431873536,
        "max_allocated_gb": 55.539557888,
        "max_reserved_gb": 61.431873536
      }
    }
  ],
  "eval_steps": [],
  "checkpoints": [],
  "metadata": {
    "world_size": 2,
    "device": "cuda:0",
    "dtype": "bfloat16",
    "compile": true,
    "use_zero1": true,
    "use_fsdp": false
  },
  "end_time": "2025-11-15T15:23:19.022087",
  "summary": {
    "total_iterations": 11,
    "final_iter": 100,
    "final_train_loss": 4.994311809539795,
    "best_val_loss": 1000000000.0,
    "avg_time_ms": 14518.899809230457,
    "avg_mfu": 36.70937505585117,
    "total_eval_steps": 0,
    "total_checkpoints": 0
  }
}